import { EmbedStory } from '@upskill-app/ui/web';

<CodeWithTabs>

### !!tabs Preview

<EmbedStory
  storyId="tutorials-profile-ui-components-profile-timeline--default"
  width={480}
  height={650}
/>

### !!tabs post-card.tsx

```tsx
import {
  Button,
  Card,
  CardBody,
  CardFooter,
  CardHeader,
  cn,
  Dropdown,
  DropdownItem,
  DropdownMenu,
  DropdownTrigger,
  Link,
  User,
} from '@nextui-org/react';
import { Subtle } from './typography.tsx'; // We've defined the 'Subtle' component in the Section 3: Designing the Profile Information Section
import { MarkdownRenderer } from './markdown-renderer.tsx';
import { Ellipsis } from 'lucide-react';

import { PostActionType, PostCardProps, PostMenuActionType } from './types';
import { formatDate, getAvatarFallback } from './utils'; // We've defined the 'getAvatarFallback' function in the Section 3: Designing the Profile Information Section
import {
  getPostActionCount,
  getPostActions,
  getPostMenuActions,
} from './post-card.utils';

export const PostCard = ({
  postId,
  createdAt,
  content,
  authorName,
  authorUsername,
  avatar,
  isSelfPost,
  postActionConfig,
  postMenuActionConfig,
  className,
  ...rest
}: PostCardProps) => {
  const postActions = getPostActions();
  const postMenuActions = getPostMenuActions({
    isSelfPost,
  });

  const handleOnMenuDropdownAction = (type: PostMenuActionType) => {
    return () => postMenuActionConfig?.[type](postId);
  };

  const handleOnPostAction = (type: PostActionType) => {
    return () => postActionConfig?.[type].handler(postId);
  };

  return (
    <Card isPressable className={cn('mb-4 last:mb-0', className)} {...rest}>
      <CardHeader className="justify-between">
        <div className="flex gap-1">
          <User
            name={authorName}
            description={
              <Link href="#" size="sm" isExternal>
                {`@${authorUsername}`}
              </Link>
            }
            avatarProps={{
              src: avatar,
              fallback: getAvatarFallback(authorName),
            }}
          />
          <Subtle className="mt-1 text-xs">Â· {formatDate(createdAt)}</Subtle>
        </div>
        {postMenuActionConfig ? (
          <Dropdown
            placement="bottom-end"
            classNames={{
              content: 'bg-content2',
            }}
          >
            <DropdownTrigger>
              <Button size="sm" variant="light" isIconOnly>
                <Ellipsis size={14} />
              </Button>
            </DropdownTrigger>
            <DropdownMenu>
              {postMenuActions.map(({ title, icon, type }) => (
                <DropdownItem
                  key={type}
                  aria-label={title}
                  color={type === 'delete' ? 'danger' : 'default'}
                  endContent={icon}
                  onClick={handleOnMenuDropdownAction(type)}
                >
                  {title}
                </DropdownItem>
              ))}
            </DropdownMenu>
          </Dropdown>
        ) : null}
      </CardHeader>
      <CardBody className="text-sm">
        <MarkdownRenderer>{content}</MarkdownRenderer>
      </CardBody>
      {postActionConfig ? (
        <CardFooter className="flex justify-around">
          {postActions.map(({ icon, type }) => {
            const content = getPostActionCount(type, postActionConfig);
            return (
              <Button
                key={type}
                size="sm"
                variant="light"
                startContent={icon}
                isIconOnly={content === null}
                onClick={handleOnPostAction(type)}
              >
                {content}
              </Button>
            );
          })}
        </CardFooter>
      ) : null}
    </Card>
  );
};

```

### !!tabs profile-timeline

```tsx
import { Tab, Tabs } from '@nextui-org/react';

import { ProfileTimelineProps } from './types';
import { useTimelineTabs } from './use-timeline-tabs';

export const ProfileTimeline = ({
  posts,
  photos,
  likedPosts,
}: ProfileTimelineProps) => {
  const tabs = useTimelineTabs({ likedPosts, photos, posts });

  return (
    <section className="flex w-full flex-col">
      <Tabs
        aria-label="Profile timeline"
        color="primary"
        fullWidth
        variant="underlined"
        items={tabs}
        destroyInactiveTabPanel={false}
        classNames={{
          base: 'sticky top-0 z-50 bg-background',
        }}
      >
        {(item) => (
          <Tab key={item.id} title={item.label}>
            <div className="px-2">{item.content}</div>
          </Tab>
        )}
      </Tabs>
    </section>
  );
};

```

### !!tabs use-timeline-tabs.tsx

```tsx
import React from 'react';

import { ProfileTimelineProps } from '../types';
import { Photos } from './photos';
import { Posts } from './posts';

export const useTimelineTabs = ({
  likedPosts,
  photos,
  posts,
}: ProfileTimelineProps) => {
  const tabs = React.useMemo(() => {
    return [
      {
        id: 'posts',
        label: 'Posts',
        content: <Posts posts={posts} />,
      },
      {
        id: 'photos',
        label: 'Photos',
        content: <Photos photos={photos} />,
      },
      {
        id: 'likes',
        label: 'Likes',
        content: <Posts posts={likedPosts} />,
      },
    ];
  }, [likedPosts, photos, posts]);

  return tabs;
};

```

### !!tabs markdown-renderer.tsx

```tsx
import React from 'react';
import { Image } from '@nextui-org/react';
import Markdown, { Options } from 'react-markdown';
import remarkGfm from 'remark-gfm';

const MemoizedRenderer = React.memo(
  Markdown,
  (prevProps, nextProps) =>
    prevProps.children === nextProps.children &&
    prevProps.className === nextProps.className
);

export const MarkdownRenderer = ({ children, ...rest }: Options) => {
  return (
    <MemoizedRenderer
      remarkPlugins={[remarkGfm]}
      components={{
        p({ children }) {
          return <p className="mb-2 last:mb-0">{children}</p>;
        },
        img({ src, alt }) {
          return (
            <Image src={src} alt={alt as string} width="100%" loading="lazy" />
          );
        },
      }}
      {...rest}
    >
      {children}
    </MemoizedRenderer>
  );
};

```

### !!tabs types.ts

```ts
import { CardProps } from '@nextui-org/react';

export interface PostStats {
  likes: number;
  comments: number;
  reposts: number;
}

export interface Post {
  id: string;
  content: string;
  profile: Profile; // 'Profile' interface has been already defined in the Section 3: Designing the Profile Information Section
  stats: PostStats;
  createdAt: string;
  updatedAt?: string;
}

export interface PostPhoto {
  id: string;
  src: string;
}

export type ProfileTimelineProps = {
  posts: Post[];
  photos: PostPhoto[];
  likedPosts: Post[];
};

export type PostActionType =
  | 'toggleLike'
  | 'comment'
  | 'repost'
  | 'share'
  | 'bookmark';

export type PostAction = {
  title?: string;
  type: PostActionType;
  icon?: React.ReactNode;
};

type PostActionHandler = (postId: string) => void;

export type PostMenuActionType =
  | 'delete'
  | 'addToHighlights'
  | 'changeViewPermission'
  | 'report'
  | 'unlike';

export type PostActionConfig = Record<
  PostActionType,
  {
    count?: number;
    handler: PostActionHandler;
  }
>;

export type PostMenuActionConfig = Record<
  PostMenuActionType,
  PostActionHandler
>;

export type PostCardProps = CardProps & {
  postId: string;
  authorName: string;
  authorUsername: string;
  avatar?: string;
  content: string;
  isSelfPost?: boolean;
  createdAt: string;
  postActionConfig?: PostActionConfig;
  postMenuActionConfig?: PostMenuActionConfig;
};

export type PhotoCardProps = {
  photoId: string;
  photoSrc: string;
  onPress?: (id: string) => void;
};

export type PhotosProps = {
  photos: PostPhoto[];
};

```

</CodeWithTabs>

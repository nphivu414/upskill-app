import { Link } from '@nextui-org/react'
import { CollapsibleBlock } from '../../collapsible-block.tsx'
import { CodeTabTrigger } from '../../code-tab-trigger.tsx'

import {
   steps
} from '../step-config.tsx'

<CodeWithAccoridions stepConfigs={steps}>
## !!accordions Section 1: Setup and initialize a new React project with NextUI

Before we dive into coding the profile page, let's set up our project:

1.  **Prerequisites:** Ensure you have Node.js, yarn (or npm) and git installed on your machine.
2.  **Clone our starter repo:** Open your terminal and run the following command to clone the starter repository:

```bash
git clone https://github.com/upskillsdev/starter-app.git
```

3.  **Start Development Server:** Install the dependencies to start the local server:

```bash
cd starter-app && yarn install
```

```bash
yarn dev
```

You should have a startup screen at `http://localhost:5173/` in your browser.
Now you can now head over to the `src/pages/index.tsx` file and start building the search flight page.

## !!accordions Section 2: Building Flight Header Component

In this section, we will build the flight header component that displays the flight details and allows users to perform actions like going back and sharing the flight details.
The component will also support sticky behavior and hide on scroll so that it doesn't take up too much space on the screen.

1. Files and Structure:
   - <CodeTabTrigger section="flight-header" tab="flight-header.tsx"/>: This file contains the flight header component.
   - <CodeTabTrigger section="flight-header" tab="use-hide-on-scroll-header.ts"/>: A custom hook for hiding the header on scroll.
   - <CodeTabTrigger section="flight-header" tab="typography.tsx"/>: This file contains the typography components for the flight header.
   - <CodeTabTrigger section="flight-header" tab="utils.ts"/>: Utility functions for formatting dates.
   - <CodeTabTrigger section="flight-header" tab="constants.ts"/>: This file contains the constants for the flight header component like height and animation duration.
   - <CodeTabTrigger section="flight-header" tab="types.ts"/>: This file contains the types for the flight header component. Types defined separetely here to be reused in other components later on.

2. New dependencies:
   - `lucide-react`: A library of simply beautiful open-source icons. Install it using `yarn add lucide-react`.

3. Deep dive into <CodeTabTrigger section="flight-header" tab="flight-header.tsx">flight-header.tsx</CodeTabTrigger> file:
   - **Props:** The component accepts the following props:
     - `from`: The departure city.
     - `to`: The arrival city.
     - `departureDate`: The departure date.
     - `returnDate`: The return date.
     - `cabinClass`: The cabin class.
     - `handleBack`: A function to handle the back action.
     - `handleShare`: A function to handle the share action.
     - `sticky`: A boolean to make the header sticky.
     - `shouldHideOnScroll`: A boolean to hide the header on scroll.
     - `parentScrollY`: A motion value to track the scroll position.
   - **Rendering:**  The component layout is divided into 3 columns:
     - **Back Button:** A button to go back to the previous page.
     - **Flight Details:** The flight details like departure city, arrival city, departure date, return date, and cabin class.
     - **Share Button:** A button to share the flight details.
   - **Sticky Header:** A whole component is wrapped in a `motion.div` to enable hide/show animations. We created a custom hook called `useHideOnScrollHeader` to return the `props` needed for the animation.
   ```tsx
      // !mark(1:1)
      const motionsProps = useHideOnScrollHeader(parentScrollY, shouldHideOnScroll);
      return (
         <motion.div
            // !mark(1:1)
            {...motionsProps}
         >
            ...
         </motion.div>
   ```

4. Deep dive into <CodeTabTrigger section="flight-header" tab="use-hide-on-scroll-header.ts">use-hide-on-scroll-header.ts</CodeTabTrigger> file:
   - **Custom Hook:** This hook is responsible for hiding the header on scroll. It takes the parent scroll position and the hide on scroll flag as arguments.
   - **State and Ref Initialization:**
      - `showHeader`: State to track if the header is visible.
      - `lastScrollYRef`: Ref to store the last scroll position.
   - **Effect Hook:**
      - We use `useEffect` to subscribes to changes in `parentScrollY` if `parentScrollY` and `shouldHideOnScroll` are provided.
      - **Conditions to Hide Header**: If the current scroll position (latest) is **greater than** the last scroll position **plus the threshold** (thresshold), hide the header. We use a threshold to avoid flickering due to small scroll changes.
      - **Conditions to Show Header**: If the current scroll position is **less than** the last scroll position **minus the threshold**, show the header. If the current scroll position is less than or equal to 0 (top of the page), show the header.

Now that we have a good understanding of the setup and the flight header component, let's start building the next component: the `<FlightCard/>`.

## !!accordions Section 3: Building Flight Card Component

In this section, we will build the flight card component that displays the flight details like airline name, cabin class, aircraft type, and logo.
The card will also show the flight timeline, fare details, and benefits like meals, entertainment, etc. The component will be reusable and flexible to accommodate different flight details.

1. Files and Structure:
   - <CodeTabTrigger section="flight-card" tab="flight-card.tsx"/>: The main file that contains the flight card component.
   - <CodeTabTrigger section="flight-card" tab="flight-overview.tsx"/>: A component that shows overview info as a header of the flight card.
   - <CodeTabTrigger section="flight-card" tab="flight-timeline.tsx"/>: A component that shows the timeline of the flight including departure, arrival, stops, and duration.
   - <CodeTabTrigger section="flight-card" tab="flight-fare-details.tsx"/>: A component that shows the fare details of the flight.
   - <CodeTabTrigger section="flight-card" tab="flight-logo.tsx"/>: A component that displays the airline logo.
   - <CodeTabTrigger section="flight-card" tab="flight-benefits.tsx"/>: A component that displays the benefits of the flight like meals, entertainment, etc.
   - <CodeTabTrigger section="flight-card" tab="utils.ts"/>: Utility functions for getting the right benefit icons.
   - <CodeTabTrigger section="flight-card" tab="constants.ts"/>: This file contains the constants for flight cabin class mapping.
   - <CodeTabTrigger section="flight-card" tab="types.ts"/>: This file contains the types for the flight card component. Types defined separetely here to be reused in other components later on.

2. Deep dive into <CodeTabTrigger section="flight-card" tab="flight-card.tsx">flight-card.tsx</CodeTabTrigger> file:
   - **Props:** The component accepts the following props:
     - `airline`: The airline details.
     - `cabinClass`: The cabin class.
     - `aircraftType`: The aircraft type.
     - `departure`: The departure details.
     - `arrival`: The arrival details.
     - `stops`: The stops in the flight.
     - `duration`: The duration of the flight.
     - `price`: The price of the flight.
     - `benefits`: The benefits of the flight.
     - `isRoundTrip`: A boolean to indicate if the flight is round trip.
   - **Structure:** The component is divided into three main sections:
     - **Header:** The header section displays the airline name, cabin class, aircraft type, and logo.
     - **Body:** The body section displays the flight timeline and fare details.
     - **Footer:** The footer section displays the benefits of the flight.
   - **Rendering:** We're usong the `Card` component from `@nextui-org/react` to render the flight card. `CardHeader`, `CardBody`, and `CardFooter` are used to structure the card content.

3. Deep dive into <CodeTabTrigger section="flight-card" tab="flight-overview.tsx">flight-overview.tsx</CodeTabTrigger> file:
   - **Props:** The component accepts the following props:
     - `airline`: The airline details.
     - `cabinClass`: The cabin class.
     - `aircraftType`: The aircraft type.
   - **Rendering:** The component renders the airline logo, name, cabin class, and aircraft type. 

</CodeWithAccoridions>
